<?phpsession_start();$articleInfo = array();if ($_REQUEST["articleId"]){   $articleInfo = EWCore::process_command("admin", "ContentManagement", "get_article", array("articleId" => $_REQUEST["articleId"]));}else{   $articleInfo["parent_id"] = $_REQUEST["parent"];   $articleInfo = json_encode($articleInfo);}function inputs(){   ob_start()   ?>   <input type="hidden" id="parent_id" name="parent_id" value="">   <?php   return ob_get_clean();}function script(){   ob_start()   ?>   <script>      function Article()      {         var self = this;         this.bAdd = EW.addActivity({title: "tr{Save}", defaultClass: "btn-success", activity: "app-admin/ContentManagement/add_article",            postData: function ()            {               if (!$("#article-form").EW().validate())               {                  return false;               }               var data = ContentForm.getFormData();               data.content = tinymce.activeEditor.getContent();               return data;            },            onDone: function (data)            {               $.EW("getParentDialog", $("#article-form")).trigger("close");               $("body").EW().notify(data).show();               $(document).trigger("article-list.refresh");            }}).hide();         this.bEdit = EW.addActivity({title: "tr{Save Changes}", defaultClass: "btn-success", activity: "app-admin/ContentManagement/update_article",            postData: function ()            {               if (!$("#article-form").EW().validate())               {                  return false;               }               var data = ContentForm.getFormData();               data.content = tinymce.activeEditor.getContent();               //ContentForm.getFormData();               return data;            },            onDone: function (data)            {               //$.EW("getParentDialog", $("#article-form")).trigger("close");               $("body").EW().notify(data).show();               ContentForm.setData(data.data);               $(document).trigger("article-list.refresh");            }}).hide();         this.bDelete = EW.addActivity({title: "tr{Delete}", defaultClass: "btn-danger", activity: "app-admin/ContentManagement/delete_article",            postData: function ()            {               if (!$("#content-form").EW().validate())               {                  return false;               }               var data = $.parseJSON($("#article-form").serializeJSON());               data.content = tinymce.activeEditor.getContent();               return data;            },            onDone: function (data)            {               $.EW("getParentDialog", $("#article-form")).trigger("close");               EW.setHashParameter("articleId", null);               $("body").EW().notify(data).show();               $(document).trigger("article-list.refresh");            }}).hide();         //$.datepicker.setDefaults($.datepicker.regional[ "" ]);         /*$("#date_created").datepicker(          {          format: "yy-mm-dd"          });*/         $("#article-form").on("refresh", function (e, data) {            //console.log(data.id);            if ($("#article-form #id").val())            {               article.bAdd.comeOut(300);               article.bEdit.comeIn(300);               article.bDelete.comeIn(300);               $("#form-title").html("<span>tr{Edit}</span>" + data.title);               $("#date_created").val(data.round_date_created);            }            else            {               article.bAdd.comeIn(300);               article.bEdit.comeOut(300);               article.bDelete.comeOut(300);            }         });      }      Article.prototype.newArticleForm = function ()      {         //article.bAdd.comeIn(300);      };      Article.prototype.editArticleForm = function ()      {         //article.bEdit.comeIn(300);         //   article.bDelete.comeIn(300);      };      Article.prototype.dispose = function ()      {         article.bAdd.remove();         article.bEdit.remove();         article.bDelete.remove();      };      function MadFileBrowser(field_name, url, type, win)      {         tinymce.activeEditor.windowManager.open({            file: "Tools/tinymce/mfm/mfm.php?field=" + field_name + "&url=" + url + "",            title: 'File Manager',            width: 840,            height: 450,            resizable: "no",            inline: "yes",            close_previous: "no"         }, {            window: win,            input: field_name         });      }      var article = new Article();      /*EW.addURLHandler(function ()       {       alert("inja");       });*/   </script>   <?php   return ob_get_clean();}EWCore::register_form("ew-content-form-proerties", "article-properties", "", inputs());echo admin\ContentManagement::get_content_form(["formId" => "article-form", "contentType" => "article", "script" => script(), "data" => $articleInfo]);